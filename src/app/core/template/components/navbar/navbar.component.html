<nav class="navbar" (keydown.escape)="closeAll()">
  <div class="center">
    <div class="search">
      <i class="fa fa-search search-ic"></i>
      <input
        type="text"
        class="search-input"
        placeholder="Rechercher..."
        [(ngModel)]="q"
        (keyup.enter)="onSearch(q)"
      />
    </div>
  </div>

  <div class="right">
    <div class="dropdown" [class.open]="isLangOpen">
      <button class="pill-btn" (click)="toggleLang($event)">
        <img [src]="selectedFlag" alt="Flag" class="flag" />
        <i class="fa fa-chevron-down chevron"></i>
      </button>

      <ul class="menu lang-menu" *ngIf="isLangOpen">
        <li *ngFor="let l of lang" (click)="switchLanguage(l.code)">
          <img [src]="l.flag" alt="Flag" class="flag" />
          <span>{{ l.name }}</span>
        </li>
      </ul>
    </div>

    <div class="dropdown" [class.open]="isNotifOpen">
      <button class="icon-btn" (click)="toggleNotif($event)">
        <i class="fa fa-bell"></i>
        <span *ngIf="notifCount > 0" class="badge">{{ notifCount }}</span>
      </button>

      <div class="menu notif-menu" *ngIf="isNotifOpen">
        <div class="menu-header">Dernières notifications</div>
        <div class="notif-item">Nouvelle tâche assignée</div>
        <div class="notif-item">Document validé avec succès</div>
        <div class="notif-item">Profil mis à jour</div>
        <div class="menu-footer">
          <a [routerLink]="'/notifications'">Tout voir</a>
        </div>
      </div>
    </div>

    <div class="dropdown" [class.open]="isProfileOpen">
      <button class="avatar-btn" (click)="toggleProfile($event)">
        <div class="avatar">{{ getInitials(username) }}</div>
      </button>

      <ul class="menu profile-menu" *ngIf="isProfileOpen">
        <li>
          <a [routerLink]="'/profile'"><i class="fa fa-user item-ic"></i> Mon profil</a>
        </li>
        <li>
          <a><i class="fa fa-edit item-ic"></i> Modifier mon profil</a>
        </li>
        <li (click)="logout()" class="danger">
          <i class="fa fa-sign-out item-ic"></i> Se déconnecter
        </li>
      </ul>
    </div>
  </div>
</nav>
